<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Liste - https://dwightaspencer.com/">
    <title>Privacy Canaries: A better tweety bird | Dwight Spencer - 0x5DCBF78E3F9C3FE3</title>
    <meta name="description" content="">
    <meta property="og:url" content="https://dwightaspencer.com/posts/01-a-better-tweedy-bird/">
  <meta property="og:site_name" content="Dwight Spencer - 0x5DCBF78E3F9C3FE3">
  <meta property="og:title" content="Privacy Canaries: A better tweety bird">
  <meta property="og:description" content="Warrent Canaries A warrant canary is a statement that declares that an organization has not taken certain actions or received certain requests for information from government or law enforcement authorities. Many services use warrant canaries to let users know how private their data is. There are even attempts to formulize to a standard such as Canarytail.
Though the standard exposes a lot of meta data about the types of request of information and related nature of hush order issued doing the case which could potentially lead to legal issues.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-01-20T02:43:33-05:00">
    <meta property="article:modified_time" content="2025-01-20T02:43:33-05:00">

    
  <meta itemprop="name" content="Privacy Canaries: A better tweety bird">
  <meta itemprop="description" content="Warrent Canaries A warrant canary is a statement that declares that an organization has not taken certain actions or received certain requests for information from government or law enforcement authorities. Many services use warrant canaries to let users know how private their data is. There are even attempts to formulize to a standard such as Canarytail.
Though the standard exposes a lot of meta data about the types of request of information and related nature of hush order issued doing the case which could potentially lead to legal issues.">
  <meta itemprop="datePublished" content="2025-01-20T02:43:33-05:00">
  <meta itemprop="dateModified" content="2025-01-20T02:43:33-05:00">
  <meta itemprop="wordCount" content="803">
    
  


    <link rel="canonical" href="https://dwightaspencer.com/posts/01-a-better-tweedy-bird/">
    <link rel="icon" href="https://dwightaspencer.com//assets/favicon.ico">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link href="https://www.google-analytics.com" rel="preconnect" crossorigin>
    <link rel="alternate" type="application/atom+xml" title="Dwight Spencer - 0x5DCBF78E3F9C3FE3" href="https://dwightaspencer.com//atom.xml" />
    <link rel="alternate" type="application/json" title="Dwight Spencer - 0x5DCBF78E3F9C3FE3" href="https://dwightaspencer.com//feed.json" />
    <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bricolage+Grotesque">
    
    
    <style>*,:after,:before{box-sizing:border-box;padding:0}body{font:1rem/1.5 bricolage grotesque,-apple-system,BlinkMacSystemFont,segoe ui,Helvetica,Arial,sans-serif;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding:2rem;background:#fffdfa;color:#000}.skip-link{position:absolute;top:-40px;left:0;background:#eee;z-index:100}.skip-link:focus{top:0}header{line-height:2;padding-bottom:1.5rem}.link{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.time{font-variant-numeric:tabular-nums;white-space:nowrap}blockquote{border-left:5px solid #eee;padding-left:1rem;margin:0}a,a:visited{color:inherit}a:hover,a.heading-link{text-decoration:none}pre{padding:.5rem;overflow:auto;overflow-x:scroll;overflow-wrap:normal}code,pre{font-family:San Francisco Mono,Monaco,consolas,lucida console,dejavu sans mono,bitstream vera sans mono,monospace;font-size:normal;font-size:small;background:#eee}code{margin:.1rem;border:none}ul{list-style-type:square}ul,ol{padding-left:1.2rem}.list{line-height:2;list-style-type:none;padding-left:0}.list li{padding-bottom:.1rem}.meta{color:#777}.content{max-width:70ch;margin:0 auto}header{line-height:2;display:flex;justify-content:space-between;padding-bottom:1rem}header a{text-decoration:none}header ul{list-style-type:none;padding:0}header li,header a{display:inline}h2.post{padding-top:.5rem}header ul a:first-child{padding-left:1rem}.nav{height:1px;background:#000;content:'';max-width:10%}.list li{display:flex;align-items:baseline}.list li time{flex:initial}.hr-list{margin-top:0;margin-bottom:0;margin-right:.5rem;margin-left:.5rem;height:1px;border:0;border-bottom:1px dotted #ccc;flex:1 0 1rem}.m,hr{border:0;margin:3rem 0}img{max-width:100%;height:auto}.post-date{margin:5% 0}.index-date{color:#9a9a9a}.animate-blink{animation:opacity 1s infinite;opacity:1}@keyframes opacity{0%{opacity:1}50%{opacity:.5}100%{opacity:0}}.tags{display:flex;justify-content:space-between}.tags ul{padding:0;margin:0}.tags li{display:inline}.avatar{height:120px;width:120px;position:relative;margin:-10px 0 0 15px;float:right;border-radius:50%}table{width:100%;border-collapse:collapse}th,td{border:1px solid #ddd;text-align:left;padding:8px}th{background-color:#f2f2f2} </style>
  
    
  
  
  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "articleSection": "posts",
      "name": "Privacy Canaries: A better tweety bird",
      "headline": "Privacy Canaries: A better tweety bird",
      "alternativeHeadline": "",
      "description": "Warrent Canaries A warrant canary is a statement that declares that an organization has not taken certain actions or received certain requests for information from government or law enforcement authorities. Many services use warrant canaries to let users know how private their data is. There are even attempts to formulize to a standard such as Canarytail.\nThough the standard exposes a lot of meta data about the types of request of information and related nature of hush order issued doing the case which could potentially lead to legal issues.",
      "inLanguage": "en-us",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https:\/\/dwightaspencer.com\/posts\/01-a-better-tweedy-bird\/"
      },
      "author" : {
          "@type": "Person",
          "name": "Dwight Spencer"
      },
      "creator" : {
          "@type": "Person",
          "name": "Dwight Spencer"
      },
      "accountablePerson" : {
          "@type": "Person",
          "name": "Dwight Spencer"
      },
      "copyrightHolder" : "Dwight Spencer - 0x5DCBF78E3F9C3FE3",
      "copyrightYear" : "2025",
      "dateCreated": "2025-01-20T02:43:33.00Z",
      "datePublished": "2025-01-20T02:43:33.00Z",
      "dateModified": "2025-01-20T02:43:33.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "Dwight Spencer - 0x5DCBF78E3F9C3FE3",
          "url": "https://dwightaspencer.com/",
          "logo": {
              "@type": "ImageObject",
              "url": "https:\/\/dwightaspencer.com\/",
              "width":"32",
              "height":"32"
          }
      },
      "image": "https://dwightaspencer.com/",
      "url" : "https:\/\/dwightaspencer.com\/posts\/01-a-better-tweedy-bird\/",
      "wordCount" : "803",
      "genre" : [ ],
      "keywords" : [ ]
  }
  </script>
  
  
  </head>

<body>
  <a class="skip-link" href="#main">Skip to main</a>
  <main id="main">
  <div class="content">
    <header>
<p style="padding: 0;margin: 0;">
  <a href="https://dwightaspencer.com/">
    <b>Dwight Spencer - 0x5DCBF78E3F9C3FE3</b>
    <span class="text-stone-500 animate-blink">â–®</span>
  </a>
</p>
<ul style="padding: 0;margin: 0;">
  
  
  </li>
</ul>
</header>
<hr class="hr-list" style="padding: 0;margin: 0;">
    <section>
      <h2 class="post">Privacy Canaries: A better tweety bird</h2>
      <h1 id="warrent-canaries">Warrent Canaries</h1>
<p>A warrant canary is a statement that declares that an organization has
not taken certain actions or received certain requests for information from
government or law enforcement authorities. Many services use warrant canaries
to let users know how private their data is. There are even attempts to
formulize to a standard such as
<a href="https://github.com/canarytail/standard">Canarytail</a>.</p>
<p>Though the standard exposes a lot of meta data about the types of request of
information and related nature of hush order issued doing the case which could
potentially lead to legal issues.</p>
<p>What Warrent Canaries are trying to solve is a public trust and disclosure
issue with a simple ascii text file that disclosures as of a date and time
that an entite has not been issued any legal actions to disclosure user data
to law enforcement or intelligence agencies. Tipically this statement includes
a timestamp, a text block of the attestation, and a pgp signature of the
attestation. The text file is usually located as <code>canary.txt</code> in the same
locations as a <code>robots.txt</code>, <code>security.txt</code>, and <code>humans.txt</code> either
<code>/.well-known/canary.txt</code> or <code>/</code> of the site.</p>
<h2 id="how-to-improve">How to improve</h2>
<p>While having a statement in one&rsquo;s Privacy page is a great start. It is in
this author&rsquo;s option that any url and pgp signed content can been exploited
in some manner or gone unnoticed.</p>
<p>So lets break down the solution. We have:</p>
<ol>
<li>a timestamp</li>
<li>an attestation that when exists is trusted but missing the whole service is
invalid</li>
<li>an cryptographic signature with of the above attributes</li>
<li>a cryptographic varifable issuer identy</li>
<li>a ring of trust been service provider and end user</li>
</ol>
<p>Sounds lot like two established core systems in a trusted computing network.
SSL and DKIM.</p>
<p>Adding a signed attestation to a TXT record for DNS record on the root of
the domain then extending the SSL certificate&rsquo;s SAN attibutes to include the
attestation automatically bakes the Canary into the existing infrastructure.</p>
<h3 id="why-dns-and-ssl-certs">Why DNS and SSL Certs</h3>
<p>Simplely put we have well established the network is a source of truth. Not
the endpoint or client. Canarytail sets up yasaas with client and endpoint
trust plus exposes risk of legal recourse. While using a text file places
trust in users to actively validate on thier own or even have the issuing
body publicly announce the canary and its removial. We known by now a Human factor
is always falable.</p>
<p>Instead by adding a single attribute to the domain&rsquo;s SSL certificate and an
attestation DNS record then when the Canary is triggered the issuer only needs to
remove the DNS record for both the SSL certificate and Canary to be invalid.
Further more when one revokes the Canary attribute and reissue the certificate all
end clients will receive instant notice of when the Canary and service is no longer
trusted.</p>
<h3 id="why-not-a-response-header-just-a-dns-record-or-blockchain">Why not a response header, just a DNS record, or blockchain</h3>
<p>First both response headers and DNS records are able to be intercepted,
overwriten on the fly, misconfigured, or even generated dynamically.</p>
<p>While DNS <em>is</em> a distributed ledger and with Proper DKIM and domain security
setup one can trust the zone of authority for the attestation but misses half
the solution&rsquo;s goals. Having a SSL certificate involved solves for end
clients instantly being alerted at the handshake.</p>
<p>As for a blockchain that in itself is not intergrated into the common every
day web. Only <code>#cryptobros</code> and cypherpunks would look to very an attestation
which is exactly the same issue using a <code>canary.txt</code> file minus any sort of
logging/monitoring infrastructure on the canary.</p>
<h2 id="logging">Logging</h2>
<p>SSL certificate failures are well known and <a href="https://sslinsights.com/how-to-fix-invalid-ssl-tls-certificate-error/">how to
fix</a>.</p>
<p>Logging for <a href="https://httpcodes.fyi/526/">HTTP Status code 526</a> is an instant
alert for both servers and clients that the Canary has died. This works even
with WAFS since some of the common causes of this are:</p>
<ul>
<li>The certificate has expired</li>
<li>The certificate has been revoked</li>
<li>The certificate is self-signed</li>
<li>Your website configuration is serving a certificate for the wrong domain</li>
</ul>
<p>Note two key parts hear; certificate been revoked and/or invalid domain. The
exact parts we are looking to validate of the canary&rsquo;s attestation.</p>
<h2 id="examples">Examples</h2>
<p>Given a canary has died and an issuer has revoked the certificate then one
will see something like the following.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ getent host canary.dapla.net
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;pgp ascii armor attestation&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ openssl s_client -connect canary.dapla.net:443 -status -msg -debug
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;</span> TLS 1.3, Alert <span style="color:#f92672">[</span>length 0002<span style="color:#f92672">]</span>, fatal handshake_failure
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">02</span> <span style="color:#ae81ff">28</span>
</span></span><span style="display:flex;"><span>4027024682740000:error:0A000410:SSL routines:ssl3_read_bytes:ssl/tls alert handshake failure:../ssl/record/rec_layer_s3.c:907:SSL alert number <span style="color:#ae81ff">40</span>
</span></span></code></pre></div><p>In this Case the domain still exists within DNS Caches but the attesation is
instantly failed when revoked and the ascii armor signature no longer matches.</p>
<p>Revoking the DNS record still has the same effect but incures a delay of
Propergation.</p>
<p>Adding the records is simple. The certificate SAN is updated with the Canary
sub domain then the fingerprint of the certrtificate is added to the DNS
domain as a TXT record.</p>

      
      <div class="post-date">
        <span class="g time">January 20, 2025 </span> &#8729;
         
      </div>
      
    </section>
    
    
    
  </div>
</main>
</body>
</html>
